<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WSI Predictions Viewer</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.1/openseadragon.min.js"></script>
</head>

<body>
  <!-- Top bar -->
  <header class="topbar">
    <div class="brand">WSI Predictions Viewer</div>
    <button id="drawerToggle" class="btn-ghost" title="Open controls">Controls</button>
  </header>

  <!-- Scrim behind drawer (click to close) -->
  <div id="drawerScrim" class="drawer-scrim"></div>

  <!-- Right-side drawer with all controls (same IDs as before) -->
  <aside id="drawer" class="drawer" aria-label="Controls">
    <div class="drawer-header">
      <div class="drawer-title">Controls</div>
      <button id="drawerClose" class="btn-ghost" title="Close controls">✕</button>
    </div>

    <div class="controls">
      <!-- Slide -->
      <div class="card">
        <div class="card-title">Slide</div>
        <label class="select-wrap" title="Pick a test slide">
          <span>Choose</span>
          <select id="slideSelect"></select>
        </label>
      </div>

      <!-- Prediction heatmap -->
      <div class="card">
        <div class="card-title">Prediction</div>
        <button id="toggle" title="Show/Hide model heatmap">Show / Hide Heatmap</button>
        <label class="range-wrap" title="Adjust overlay strength">
          <span>Opacity</span>
          <input type="range" id="opacity" min="0" max="1" step="0.01" value="0.5" />
        </label>
        <small class="hint">Classic heatmap over the slide.</small>
      </div>

      <!-- Ground truth -->
      <div class="card">
        <div class="card-title">Ground Truth</div>
        <button id="toggleGT" title="Show/Hide GT regions">Toggle GT</button>
        <small class="hint">GT shown as red blocks.</small>
      </div>

      <!-- Errors (FP/FN) -->
      <div class="card">
        <div class="card-title">Errors</div>
        <button id="toggleFPFN" title="Show false positives / negatives">Show FP/FN</button>
        <label class="range-wrap" title="Probability threshold for positives">
          <span>Threshold</span>
          <input type="range" id="thresh" min="0" max="1" step="0.01" value="0.5" />
          <input type="number" id="threshNum" min="0" max="1" step="0.01" value="0.5" />
        </label>
        <small class="hint">FP = amber, FN = cyan.</small>
      </div>

      <!-- Status -->
      <div class="card status-card">
        <div class="card-title">Status</div>
        <span id="status" class="status">ready</span>
      </div>
    </div>
  </aside>

  <main>
    <div id="viewer"></div>

    <!-- toast for quick messages -->
    <div id="toast" class="toast"></div>

    <!-- Heatmap legend -->
    <div class="legend">
      <div class="legend-title">Prediction probability</div>
      <canvas id="colorbar" width="256" height="14" aria-label="Prediction heatmap scale"></canvas>
      <div class="legend-ticks">
        <span>0</span><span>0.25</span><span>0.5</span><span>0.75</span><span>1.0</span>
      </div>
    </div>

    <!-- FP/FN legend -->
    <div id="legend-fpfn" class="legend legend-fpfn">
      <div class="legend-title">Errors (τ=<span id="legend-thresh">0.50</span>)</div>
      <div class="legend-rows">
        <div class="legend-row"><span class="swatch fp"></span> False Positive</div>
        <div class="legend-row"><span class="swatch fn"></span> False Negative</div>
      </div>
    </div>
  </main>

  <script>
    window.APP_CONFIG = {
      SLIDES_INDEX_URL: "https://d1oou9hjt2kimi.cloudfront.net/slides_index.json"
    };
  </script>

  <script src="app.js"></script>
</body>
</html>



